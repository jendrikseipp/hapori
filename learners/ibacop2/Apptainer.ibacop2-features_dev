Bootstrap: docker
From: ubuntu:18.04
# Stage: build

%files 
    . 
       
%post    
    apt-get update
    apt-get install --no-install-recommends -y \
	make \
	cmake \
	gcc-multilib \
	flex \
	bison \
	g++-multilib \
    	gawk \
	pypy \
	python-pandas \
	python-sklearn

    ## Build the planner
    export MAKE_FLAGS="-j6"
    ./build

    ## Remove unnecessary files to keep the image small.
    rm -rf /var/lib/apt/lists/*
    # apt-get -y autoremove bison flex make g++

%runscript
    DOMAINFILE="$1"
    PROBLEMFILE="$2"
    FEATUREFILE="$3"
    
    ROOT=$PWD
     
    echo $DOMAINFILE
    echo $PROBLEMFILE
    echo $FEATUREFILE

    python2.7 src/launcher/genfeatures.py "$@"

%labels
Name        IBaCoP2-2018
Description New version IBaCoP2 Dynamic portfolio. The planner selection changes per instance.
Authors     Isabel Cenamor <icenamorg@gmail.com>, Tomas de la Rosa <tomas.delarosaturbides@jpmorgan.com and Fernando Fernandez <ffernand@inf.uc3m.es>
SupportsDerivedPredicates yes
SupportsQuantifiedPreconditions no
